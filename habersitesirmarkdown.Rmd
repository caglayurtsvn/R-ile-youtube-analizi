---
title: "<span style='color: purple ;'>**Sosyal Medya ve Web Analizi**</span>"
author: "<span style='color: Black ;'>**Youtube Yorum Analizi**</span>"
output:
  html_document:
    theme: journal   # ÅÄ±k bir tema seÃ§ildi (diÄŸer seÃ§enekler: united, cosmo, cerulean)
    toc: true        # Ä°Ã§indekiler tablosu ekler
    toc_float: true  # Sayfa kaydÄ±rÄ±ldÄ±ÄŸÄ±nda iÃ§indekiler sabit kalÄ±r
    number_sections: false # BÃ¶lÃ¼m numaralandÄ±rmasÄ± ekler
    df_print: paged  # BÃ¼yÃ¼k tablolar iÃ§in sayfalama Ã¶zelliÄŸi
editor_options:
  chunk_output_type: inline
---
## ğŸ“Œ **Ä°Ã§indekiler**  
1. [Ahmet Minguzzi Haber Analizi](#ahmet-minguzzi-haber-analizi)  
2. [Asgari Ãœcret Haber Analizi](#asgari-Ã¼cret-haber-analizi)  
3. [Ä°stanbul Depremi Haber Analizi](#istanbul-deprem-haber-analizi)  
4. [Ä°klim Degisikligi Haber Analizi](#iklim-deÄŸiÅŸikliÄŸi-haber-analizi)  
5. [SonuÃ§](#sonuÃ§)  

---

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
library(shiny)
library(bslib)
library(ggplot2)
library(dplyr)
library(tidytext)
library(httr)
library(jsonlite)
library(stringr)
library(DT)
library(readr)
library(showtext)
library(grid)
library(gridExtra)
library(wordcloud2)
library(igraph)
library(ggraph)
library(shinycssloaders)
library(shiny)
library(bslib)
library(tidyr)
library(openai)
library(leaflet)
library(ggwordcloud)
library(visNetwork)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
Sys.setlocale("LC_ALL", "Turkish")

```


```{r,echo=FALSE, message=FALSE, warning=FALSE}
turkce_stopwords <- c("acaba","ama","aslÄ±nda","az","bazÄ±","belki","ben","biri","birkaÃ§","birÃ§ok","bu","Ã§Ã¼nkÃ¼","da","mal","a","ilgili","te","ederiz","herkese",
                      "daha","zaman","olan","ediyorum","de","defa","diye","en","gibi","hem","hep","hepsi","her","hiÃ§","iÃ§in","ile","ise","senin","gerek","olursa",
                      "kez","ki","kim","bile","yapan","demek","bunlara","kendileri","mÄ±","mu","mÃ¼","mi","ne","neden","nerde","nerede","nereye","e","ay","hic","buna",
                      "niÃ§in","niye","o","sanki","ÅŸey","siz","kesinlikle","hala","geldi","yapar","ÅŸu","tÃ¼m","ve","veya","ya","yani","yine","istiyoruz","olarak",
                      "yok","zaten","Ã§ok","nasÄ±l","ÅŸimdi","bana","bende","beni","boyle","boyu","sana","sizi","benim","biz","bizim","bize","ediyor","devam","bizde","yaa",
                      "bizi","bunun","bunu","diÄŸer","cok","oldu","ah","a","olsun","tey","be","kat","eÄŸer","elbette","et","fakat","falan","versin","yerine","baya","biraz",
                      "filan","haliyle","halen","hangi","hani","ver","olsa","olmaz","an","edin","herkes","illa","iÅŸte","iÃ§","kadar","karÅŸÄ±n","vs","ilk","hale",
                      "kendi","kimse","onu","nasil","olabilir","madem","meÄŸer","nedenle","oluyor","yerini","diyor","ona","sadece","ÅŸayet","konu","bak","olup",
                      "v.s.","vs.","tek","olur","ye","veren","varsa","birde","yapma","yapmak","yoksa","artÄ±k","Ã¼zere","diÄŸeri","kendisi","buna","alan","asla","icin",
                      "kimseye","gelsin","ederim","dedi","onlar","bizler","sizler","bunlar","ÅŸunlar","birisi","birileri","herhangi","ÅŸekilde","evet","anda","sizin",
                      "tarafta","bence","hemen","tarafÄ±ndan","bir","iki","Ã¼Ã§","dÃ¶rt","beÅŸ","altÄ±","yedi","sekiz","dokuz","on","Ã¶nce","eden","etsin","geliyor","nin","dan",
                      "sonra","diliyorum","size","bi","ancak","arada","etrafÄ±nda","beri","yakÄ±nÄ±nda","Ã¼stÃ¼nde","altÄ±nda","iÃ§inde","yada","ahh","nedir","gelecek",
                      "dÄ±ÅŸÄ±nda","karÅŸÄ±","karÅŸÄ±sÄ±nda","var","ah","sen","seni","den","gelince","Ã¶nÃ¼nde","arkasÄ±nda","benzer","yaklaÅŸÄ±k","gelen","fazla","degil",
                      "Ã¼zerine","uzerinde","dolayÄ±","birlikte","belli","olacak","yaz","butun","kendini","bununla","dilerim","etmek","dilerim","ederiz","hatta"
)
```


# 1. Ahmet Minguzzi Haber Analizi
  *"Haber Analizimizdeki amaÃ§ toplumun Ahmet Minguzzi olayÄ± hakkÄ±nda duygu ve dÃ¼ÅŸÃ¼ncelerini Ã¶ÄŸrenmek ve bu konu hakkÄ±ndaki dÃ¼ÅŸÃ¼ncelerinden yola Ã§Ä±karak verdikleri tepkiler sayesinde analizleri gerÃ§ekleÅŸtirmek."*
```{r,echo=FALSE, message=FALSE, warning=FALSE}
dosya_yolu_ahmet <- "C:\\Users\\cyurt\\OneDrive\\Belgeler\\sosyalmedyaproje\\ahmetminguzziyorumlari.csv"
yorumlar <- read_csv(dosya_yolu_ahmet, locale = locale(encoding = "UTF-8"))

```

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorumlar_tidy <- yorumlar %>%
  unnest_tokens(kelime, Yorumlar) %>%
  filter(!kelime %in% turkce_stopwords) %>%  # Stopwords cikarma
  filter(str_detect(kelime, "^[a-z????????????]+$")) %>%  # Yalnizca harf iceren kelimeler
  mutate(kelime = str_to_lower(kelime))  # Tum kelimeleri kucuk harfe cevirme
```


```{r,echo=FALSE, message=FALSE, warning=FALSE}
kelime_frekans <- yorumlar_tidy %>%
  count(kelime, sort = TRUE)

## ilk 50 kelimeyi al
kelime_frekans_top50 <- kelime_frekans %>% 
  top_n(100, n)
```

##### Kelime Bulutu
  Youtube Ã¼zerinden alÄ±nan yorumlarÄ±n kelime analizi sonuÃ§larÄ±nda Ã¶ncelikli olarak â€œAllah, ceza, adalet, anne, Ahmet, cani, idam, katil, eylesinâ€ gibi sÃ¶zcÃ¼kler Ã¶ne Ã§Ä±kmÄ±ÅŸtÄ±r. Bunun sonucunda bu olayÄ±n bir Ã¶ldÃ¼rÃ¼lme vakasÄ± olduÄŸunu ve toplumun bu konu hakkÄ±nda aile yakÄ±nlarÄ±na baÅŸ saÄŸlÄ±ÄŸÄ± dilediÄŸini ayrÄ±ca hukuki sÃ¼recin nasÄ±l ilerlemesi gerektiÄŸini belli etmiÅŸtir. 

	"Katil", "Caniler", "Ä°dam", "Ceza", "Adalet" kelimeler ile adalet talebi oldukÃ§a yoÄŸun. KullanÄ±cÄ±lar faile karÅŸÄ± ciddi bir Ã¶fke duyuyor ve ceza talebinde bulunuyorlar. "Ä°dam" kelimesi sÄ±klÄ±kla geÃ§miÅŸ, bu da toplumsal Ã¶fkenin boyutunu gÃ¶steriyor.



```{r,echo=FALSE, message=FALSE, warning=FALSE}
wordcloud2(kelime_frekans_top50, shape = "diamond")
```

```{r,echo=FALSE, message=FALSE, warning=FALSE}
library(igraph)
library(forcats)
# En sik gecen 20 kelimeyi al
kelime_frekans_top20 <- kelime_frekans %>%
  filter(!is.na(kelime)) %>%
  top_n(20, n) %>%
  mutate(kelime = fct_reorder(kelime, n))  # S??ralama i??in

# Grafik
ggplot(kelime_frekans_top20, aes(x = n, y = kelime, fill = n)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient(low = "#a6cee3", high = "#1f78b4") +
  labs(
    title = "En Sik Gecen 20 Kelime",
    x = "Frekans",
    y = "Kelime"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    axis.text = element_text(color = "gray20"),
    axis.title = element_text(face = "bold")
  )
```


##### Emoji Analizi

  Emoji Analizinde gÃ¶rÃ¼ldÃ¼ÄŸÃ¼ Ã¼zere kelime bulutunu destekleyen emojileri barÄ±ndÄ±rÄ±yor. Bu emojiler insanlarÄ±n Ã¼zgÃ¼nlÃ¼ÄŸÃ¼nÃ¼ olayÄ±n duygusal boyutunu vurgulanmÄ±ÅŸtÄ±r. Ã–zellikle ğŸ¥º ğŸ˜­ ğŸ™ â¤ï¸ emojiler halkÄ±n tepki olarak Ã¼zÃ¼ntÃ¼lÃ¼, dua ve destek duygularÄ±nÄ± temsil ediyor.  ğŸ˜¡ ğŸ’” ğŸ˜ Ã–fke, kalp kÄ±rÄ±klÄ±ÄŸÄ± ve Ã¼zÃ¼ntÃ¼ iÃ§eren emojilerin sÄ±klÄ±ÄŸÄ± da dikkat Ã§ekmiÅŸtir. Bu da olayÄ±n sadece acÄ± deÄŸil aynÄ± zamanda Ã¶fke yarattÄ±ÄŸÄ±nÄ± da belirtiyor.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_metni <- yorumlar$Yorumlar
# Emoji Unicode aralÄ±ÄŸÄ±
emoji_pattern <- "[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\U0001F1E0-\U0001F1FF\U00002700-\U000027BF]"

# Emojileri bul
tum_emojiler <- str_extract_all(yorum_metni, emoji_pattern)
```

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Listeyi dÃ¼zleÅŸtir
tum_emojiler_flat <- unlist(tum_emojiler)

# Hangi emojiden kaÃ§ tane var
emoji_sayim <- as.data.frame(table(tum_emojiler_flat)) %>%
  arrange(desc(Freq))

# Ä°lk 10 emojiyi al
emoji_top10 <- emoji_sayim %>%
  slice_max(order_by = Freq, n = 10)

# Grafik
ggplot(emoji_top10, aes(x = reorder(tum_emojiler_flat, Freq), y = Freq, fill = Freq)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = tum_emojiler_flat), 
            hjust = -0.5, 
            size = 10, 
            family = "Segoe UI Emoji") + 
  geom_text(aes(label = Freq), 
            hjust = 1.2, 
            color = "white",
            fontface = "bold",
            size = 5) +
  scale_fill_gradient(low = "#add8e6", high = "#005f73") +
  coord_flip() +
  labs(title = "Ahmet Minguzzi Yorumlarinda En Cok KullanÄ±lan 10 Emoji", 
       subtitle = "Yorumlardan elde edilen verilere gore emoji kullanÄ±mÄ±",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )

```


##### 2'li ve 3'lÃ¼ Kelime GruplarÄ±

  En sÄ±k kullanÄ±lan 2â€™li ve 3â€™lÃ¼ kelime gruplarÄ±nÄ± incelediÄŸimizde en Ã§ok â€œAllah SabÄ±r, Rahmet Eylesin, AÄŸÄ±r ceza, Ã§ocuk deÄŸil, aÄŸÄ±r cezaâ€ kelimeleri 2li kelime gruplarÄ±nda Ã¶ne Ã§Ä±karken 3â€™lÃ¼ kelime gruplarÄ±nda â€œAllah rahmet eylesin, sÃ¶zÃ¼n bittiÄŸi yer, aÄŸÄ±r cezayÄ± alsÄ±nlar, suÃ§a sÃ¼rÃ¼klenen Ã§ocuk,â€ gibi cÃ¼mleler cinayeti iÅŸleyenlerin en aÄŸÄ±r cezayÄ± almasÄ±nÄ± hatta bunu yapanlarÄ±n Ã§ocuk olduÄŸunu anlamamÄ±za yardÄ±mcÄ± olmakta. Bu olayÄ±n toplumda bÃ¼yÃ¼k ses getirdiÄŸini suÃ§lularÄ±n en aÄŸÄ±r cezayÄ± almasÄ± gerektiÄŸini vurgulamÄ±ÅŸ ayrÄ±ca ailesine sabÄ±rlar dilemeyi de unutmadÄ±klarÄ±nÄ± sÃ¶yleyebilirim. 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_df <- tibble(yorum = yorum_metni)

# Bigram (iki kelimelik grup) ??retimi
bigramlar <- yorum_df %>%
  unnest_tokens(bigram, yorum, token = "ngrams", n = 2) %>%
  separate(bigram, into = c("kelime1", "kelime2"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d")) %>%
  unite(bigram, kelime1, kelime2, sep = " ")

# En cok gecen 15 bigram
bigram_sayim <- bigramlar %>%
  count(bigram, sort = TRUE) %>%
  slice_max(n, n = 15)

# Grafik
ggplot(bigram_sayim, aes(x = reorder(bigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#ffe0ac", high = "#ff6f00") +
  labs(title = "Ahmet Minguzzi Yorumlarinda En Sik Gecen 2'li Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```


```{r,echo=FALSE, message=FALSE, warning=FALSE}
trigramlar <- yorum_df %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  unite(trigram, kelime1, kelime2, kelime3, sep = " ")

trigram_sayim <- trigramlar %>%
  count(trigram, sort = TRUE) %>%
  slice_max(n, n = 30)

# Grafik
ggplot(trigram_sayim, aes(x = reorder(trigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#b3e5fc", high = "#0288d1") +
  labs(title = "Ahmet Minguzzi Yorumlarinda En Sik Gecen 3'lu Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```

##### Kelime AÄŸÄ±
  Kelime aÄŸÄ±nda aslÄ±nda diÄŸer analizde olanlara rastladÄ±ÄŸÄ±mÄ±zÄ± sÃ¶yleyebilirim. Ama ayÄ±ran birkaÃ§ nokta var bunlardan biri â€œemsal kararâ€ olarak bu cinayetin sonuca varmasÄ±nÄ± istediklerini, â€œtecrit edilmeliâ€ diyerek cinayeti iÅŸleyenlerin toplumdan dÄ±ÅŸlanmasÄ± gerektiÄŸini sÃ¶ylemekte. DiÄŸer bir dikkatimizi Ã§eken â€œkufi kafada elleriâ€ sÃ¶zleri aslÄ±nda bir ÅŸarkÄ± sÃ¶zÃ¼ olduÄŸunu ve toplumun bu ÅŸarkÄ± ile â€œAhmetâ€ baÄŸdaÅŸtÄ±rdÄ±ÄŸÄ±nÄ± sÃ¶yleyebiliriz.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Trigram cikarma ve temizleme
trigramlar <- yorum_df %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d"),
         str_detect(kelime1, "^[a-z????????????]+$"),
         str_detect(kelime2, "^[a-z????????????]+$"),
         str_detect(kelime3, "^[a-z????????????]+$")) %>%
  mutate(across(c(kelime1, kelime2, kelime3), str_to_lower))

# Trigramlardan bigram (kelime1-kelime2) uret ve frekans hesapla
bigram_counts <- trigramlar %>%
  count(kelime1, kelime2, sort = TRUE) %>%
  filter(n >= 4)

# En sik gecen ilk 200 bigram'i al
bigram_counts_filtered <- bigram_counts %>% 
  slice_max(order_by = n, n = 100)

#Node ile frekans hesapla (hem kelime1 hem kelime2 i??in)
node_freq1 <- bigram_counts_filtered %>%
  group_by(kelime1) %>%
  summarise(freq = sum(n)) %>%
  rename(id = kelime1)

node_freq2 <- bigram_counts_filtered %>%
  group_by(kelime2) %>%
  summarise(freq = sum(n)) %>%
  rename(id = kelime2)


node_freq_all <- bind_rows(node_freq1, node_freq2) %>%
  group_by(id) %>%
  summarise(freq = sum(freq))

nodes <- node_freq_all %>%
  mutate(label = id,
         value = freq,
         title = paste0("Kelime: ", id, "<br>Frekans: ", freq),
         color = "rgba(255,105,180,0.8)",  # Pembe ton
         font = list(size = 20))

edges <- data.frame(
  from = bigram_counts_filtered$kelime1,
  to = bigram_counts_filtered$kelime2,
  value = bigram_counts_filtered$n,
  title = paste("S??kl??k:", bigram_counts_filtered$n),
  color = list(color = "steelblue", highlight = "red")
)

# Interaktif visNetwork grafigi
visNetwork(nodes, edges, width = "100%", height = "700px") %>%
  visEdges(smooth = TRUE, arrows = "to") %>%
  visOptions(highlightNearest = list(enabled = TRUE, degree = 1, hover = TRUE),
             nodesIdSelection = TRUE) %>%
  visLayout(randomSeed = 123) %>%
  visPhysics(stabilization = TRUE) %>%
  visInteraction(navigationButtons = TRUE) %>%
  visNodes(shape = "dot", shadow = TRUE)
```



```{r}
duygu_sozlugu <- tibble(
  kelime = c("harika", "mÃ¼kemmel", "seviyorum", "gÃ¼zel", "beÄŸendim", 
             "k??t??", "berbat", "nefret", "rezalet", "Ã§irkin", 
             "asla", "tiksindim", "sevdim", "sÃ¼per", "bayildim", "hiÃ§",
             "caniligi", "acimasizlik", "canavarca", "vahÅŸice", 
             "ÅŸeytan", "vicdansiz","katil","aÅŸaÄŸlÄ±k","pislik","katil","kati","vahÅŸice"),
  duygu = c("olumlu", "olumlu", "olumlu", "olumlu", "olumlu", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", 
            "olumsuz", "olumsuz", "olumlu", "olumlu", "olumlu", "olumsuz",
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz")
)
```

##### Manuel OluÅŸturulan Duygu Analizi

  Manuel olarak yapÄ±lan duygu analizinde Bert analizinde olduÄŸu gibi burada da negatif duygular baskÄ±n Ã§Ä±kmÄ±ÅŸtÄ±r. Bunun sonucunda olayÄ±n toplumda negatif olarak deÄŸerlendirildiÄŸini sÃ¶yleyebiliriz. 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Trigram uret ve stopword'leri filtrele
trigramlar <- yorum_df %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords)

# Trigram kelimelerini duygu sozluk ile eslestir
trigram_duygu <- trigramlar %>%
  pivot_longer(cols = c(kelime1, kelime2, kelime3), 
               names_to = "pozisyon", values_to = "kelime") %>%
  left_join(duygu_sozlugu, by = "kelime") %>%
  filter(!is.na(duygu)) %>%
  count(duygu, sort = TRUE)

# Grafik cizimi
ggplot(trigram_duygu, aes(x = reorder(duygu, n), y = n, fill = duygu)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  geom_text(aes(label = n), vjust = -0.5, size = 6, fontface = "bold") +
  scale_fill_manual(values = c("olumlu" = "#4caf50", "olumsuz" = "#f44336")) +
  labs(title = "Yorumlardaki Duygu Dagilimi",
       
       x = "Duygu", y = "Kullanim Sayisi") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
        plot.subtitle = element_text(size = 13, hjust = 0.5))
```

##### Bert Ä°le Duygu Analizi

YapÄ±lan Bert analizi sonucunda yorumlarÄ±n negatif kÄ±smÄ±nÄ±n aÄŸÄ±rlÄ±klÄ± olduÄŸunu bu da olayÄ±n toplumda genel olarak olumsuz karÅŸÄ±landÄ±ÄŸÄ±nÄ± ve tepkilere neden olduÄŸu sÃ¶ylenebilir. YorumlarÄ±n matematiksel hesaplamalarÄ±nÄ± yorumlanÄ±rsa ortalama â€œ-0.393â€ yorumlarÄ±n negatif aÄŸÄ±rlÄ±klÄ± olduÄŸunu 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Dosya yolunu belirt
dosya_yolu <- "C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/yorumlar_duygu.csv"

# Veriyi oku
veri <- read_csv(dosya_yolu, locale = locale(encoding = "UTF-8"))


# Duygu dagilimini hesapla
polarite_sayilari_veri <- veri %>%
  group_by(duygu) %>%
  summarise(sayi = n())

# Grafikle goster
ggplot(polarite_sayilari_veri, aes(x = reorder(duygu, -sayi), y = sayi, fill = duygu)) +
  geom_bar(stat = "identity", width = 0.6) +
  scale_fill_manual(values = c("positive" = "#2ecc71", "neutral" = "#95a5a6", "negative" = "#e74c3c")) +
  labs(title = "Yorumlarin Polarite Dagilimi",
       x = "Duygu Turu",
       y = "Yorum Sayisi") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"))
```

# 2. Asgari Ãœcret Haber Analizi
  Asgari Ã¼cret analizinde toplumun deÄŸiÅŸen asgari Ã¼cret hakkÄ±ndaki dÃ¼ÅŸÃ¼ncelerini iÃ§eren haber yorumlarÄ±ndan alÄ±nmÄ±ÅŸtÄ±r.
  
```{r,echo=FALSE, message=FALSE, warning=FALSE}
dosya_yolu_asgari <- "C:\\Users\\cyurt\\OneDrive\\Belgeler\\sosyalmedyaproje\\asgeriucret.csv"
yorumlar_asgari <- read_csv(dosya_yolu_asgari, locale = locale(encoding = "UTF-8"))
```




```{r,echo=FALSE, message=FALSE, warning=FALSE}
# 3. Yorumlardan Stopwords cikartma ve Temizleme
yorumlar_tidy_asgari <- yorumlar_asgari %>%
  unnest_tokens(kelime, Yorumlar) %>%
  filter(!kelime %in% turkce_stopwords) %>%  # Stopwords cikarma
  filter(str_detect(kelime, "^[a-z????????????]+$")) %>%  # Yalnizca harf iceren kelimeler
  mutate(kelime = str_to_lower(kelime))  # Tum kelimeleri kucuk harfe cevirme

```

##### Kelime Bulutu 
  Kelime bulutundan elde edilen analiz ile Ã¶ne Ã§Ä±kan kelimeler â€œasgari, zam, binâ€ kavramlarÄ± konu ile alakalÄ± olan Ã¶ne Ã§Ä±kan kelimelerdir. DiÄŸer kelimeler ise â€œemekli, millet, para, enflasyon, kira, zorâ€ kelimeler Ã¶ne Ã§Ä±kmÄ±ÅŸtÄ±r. 


```{r,echo=FALSE, message=FALSE, warning=FALSE}
# 4. Kelime Frekanslarini Hesaplama
kelime_frekans_asgari <- yorumlar_tidy_asgari %>%
  count(kelime, sort = TRUE)

## ilk 50 kelimeyi al
kelime_frekans_asgaritop50 <- kelime_frekans_asgari %>% 
  top_n(60, n)

# Word Cloud'u ciz

wordcloud2(kelime_frekans_asgaritop50, shape = "star")
```

##### Emoji Analizi
  Emoji analizine baktÄ±ÄŸÄ±mÄ±zda kalp, kahkaha, Ã¼zgÃ¼n, alkÄ±ÅŸ, kÄ±zgÄ±n ifadelerin toplumun asgari Ã¼cret hakkÄ±nda emoji analizinde net bir Ã§Ä±ktÄ± edemediÄŸimi vurgulamak isterim.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
#Emoji analizi

# Yorum metinlerini cek
yorum_metni_asgari <- yorumlar_asgari$Yorumlar

# Emoji Unicode araligi
emoji_pattern <- "[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\U0001F1E0-\U0001F1FF\U00002700-\U000027BF]"

# Emojileri bul
tum_emojiler_asgari <- str_extract_all(yorum_metni_asgari, emoji_pattern)

# Listeyi duzlestir
tum_emojiler_flat_asgari <- unlist(tum_emojiler_asgari)

# Hangi emojiden kac tane var
emoji_sayim_asgari <- as.data.frame(table(tum_emojiler_flat_asgari)) %>%
  arrange(desc(Freq))

# ilk 10 emojiyi al
emoji_asgaritop10 <- emoji_sayim_asgari %>%
  slice_max(order_by = Freq, n = 10)

# Grafik
ggplot(emoji_asgaritop10, aes(x = reorder(tum_emojiler_flat_asgari, Freq), y = Freq, fill = Freq)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = tum_emojiler_flat_asgari), 
            hjust = -0.5, 
            size = 10, 
            family = "emoji") +  # Burayi degistirdik
  geom_text(aes(label = Freq), 
            hjust = 1.2, 
            color = "white",
            fontface = "bold",
            size = 5) +
  scale_fill_gradient(low = "#add8e6", high = "#005f73") +
  coord_flip() +
  labs(title = "Asgari Ucret Emojileri", 
       subtitle = "Yorumlardan elde edilen verilere gÃ¶re emoji kullanimi",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )
```


##### 2'li ve 3'lÃ¼ Kelim GruplarÄ±
  Kelime gruplarÄ±nda ise â€œasgari Ã¼cret, erken seÃ§im, dÃ¼ÅŸÃ¼k emekli maaÅŸÄ±â€ ve asgari Ã¼cret tahminleri barÄ±ndÄ±ran bu kelime gruplarÄ± bireylerin tahmini beklediÄŸinin altÄ±nda gerÃ§ekleÅŸtiÄŸini sÃ¶yleyebiliriz. Hatta asgari Ã¼cret konusu olan bu vidolarÄ±n iÃ§inde emekliye de yer verilmesi emeklilerin kendi seslerini duyurmaya Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± anlayabiliriz.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_df_asgari <- tibble(yorum = yorum_metni_asgari)

# Bigram (iki kelimelik grup) uretimi
bigramlar_asgari <- yorum_df_asgari %>%
  unnest_tokens(bigram, yorum, token = "ngrams", n = 2) %>%
  separate(bigram, into = c("kelime1", "kelime2"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d")) %>%
  unite(bigram, kelime1, kelime2, sep = " ")

# En sik gecen 15 bigram
bigram_sayim_asgari <- bigramlar_asgari %>%
  count(bigram, sort = TRUE) %>%
  slice_max(n, n = 15)

# Grafik
ggplot(bigram_sayim_asgari, aes(x = reorder(bigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#ffe0ac", high = "#ff6f00") +
  labs(title = "Asgari Ucret Yorumlarinda En Sik Gecen 2'li Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```



```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Trigram uretimi
trigramlar_asgari <- yorum_df_asgari %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  unite(trigram, kelime1, kelime2, kelime3, sep = " ")

# En sik gecen 15 trigram
trigram_sayim_asgari <- trigramlar_asgari %>%
  count(trigram, sort = TRUE) %>%
  slice_max(n, n = 15)
# Grafik
ggplot(trigram_sayim_asgari, aes(x = reorder(trigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#b3e5fc", high = "#0288d1") +
  labs(title = "Asgari Ucret Yorumlarinda En Sik Gecen 3'lÃ¼ Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```

##### Kelime AÄŸÄ±

  Kelime AÄŸÄ±nda ise â€œkira, elektrik, su, Pazarâ€ kelimeleri asgari Ã¼cretin harcanacaÄŸÄ± bireysel ihtiyaÃ§larÄ± vurgulanmÄ±ÅŸtÄ±r. Bunlar dÄ±ÅŸÄ±nda â€œmemura zamâ€ aslÄ±nda memurlarÄ±n da kendilerine zam istediÄŸini gÃ¶stermektedir.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Trigram cikarimi ve temizleme
trigramlar_asgari <- yorum_df_asgari %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d"),
         str_detect(kelime1, "^[a-z????????????]+$"),
         str_detect(kelime2, "^[a-z????????????]+$"),
         str_detect(kelime3, "^[a-z????????????]+$")) %>%
  mutate(across(c(kelime1, kelime2, kelime3), str_to_lower))

# Trigramlardan bigram (kelime1-kelime2) uret ve frekans hesapla
bigram_counts_asgari <- trigramlar_asgari %>%
  count(kelime1, kelime2, sort = TRUE) %>%
  filter(n >= 6)

# En sik gecen ilk 200 bigram'i al
bigram_counts_filtered_asgari <- bigram_counts_asgari %>% 
  slice_max(order_by = n, n = 100)

# Diam frekanslar??n?? hesapla (hem kelime1 hem kelime2 icin)
node_freq1_asgari <- bigram_counts_filtered_asgari %>%
  group_by(kelime1) %>%
  summarise(freq = sum(n)) %>%
  rename(id = kelime1)

node_freq2_asgari <- bigram_counts_filtered_asgari %>%
  group_by(kelime2) %>%
  summarise(freq = sum(n)) %>%
  rename(id = kelime2)

# Frekanslari birlestir
node_freq_all_asgari <- bind_rows(node_freq1_asgari, node_freq2_asgari) %>%
  group_by(id) %>%
  summarise(freq = sum(freq))
nodes_asgari <- node_freq_all_asgari %>%
  mutate(label = id,
         value = freq,
         title = paste0("Kelime: ", id, "<br>Frekans: ", freq),
         color = "rgba(255,105,180,0.8)",  # Pembe ton
         font = list(size = 20))

# Kenar veri cercevesi
edges_asgari <- data.frame(
  from = bigram_counts_filtered_asgari$kelime1,
  to = bigram_counts_filtered_asgari$kelime2,
  value = bigram_counts_filtered_asgari$n,
  title = paste("S??kl??k:", bigram_counts_filtered_asgari$n),
  color = list(color = "steelblue", highlight = "red")
)

# Interaktif visNetwork grafigi
visNetwork(nodes_asgari, edges_asgari, width = "100%", height = "700px") %>%
  visEdges(smooth = TRUE, arrows = "to") %>%
  visOptions(highlightNearest = list(enabled = TRUE, degree = 1, hover = TRUE),
             nodesIdSelection = TRUE) %>%
  visLayout(randomSeed = 123) %>%
  visPhysics(stabilization = TRUE) %>%
  visInteraction(navigationButtons = TRUE) %>%
  visNodes(shape = "dot", shadow = TRUE)
```


```{r,echo=FALSE, message=FALSE, warning=FALSE}
duygu_sozlugu_asgari <- tibble(
  kelime = c("harika", "mÃ¼kemmel", "seviyorum", "gÃ¼zel", "beÄŸendim", 
             "kÃ¶tÃ¼", "berbat", "nefret", "rezalet", "Ã§irkin", 
             "asla", "tiksindim", "sevdim", "sÃ¼per", "bayÄ±ldÄ±m", "hiÃ§",
             "caniligi", "acÄ±masÄ±zlÄ±k", "canavarca", "vahÅŸice", 
             "ÅŸeytan", "vicdansiz","katil","aÅŸaÄŸÄ±lÄ±k","pislik","katil","kati","vahÅŸice","yÄ±kÄ±m", "ihmal", "enkaz", "Ã§Ã¶ktÃ¼", 
             "felaket","Ã¶lÃ¼m", "korkunÃ§", "unutuldu", "Ã§aresiz", "sessizlik","korku","deprem","adaletsiz", "dÃ¼ÅŸÃ¼k", "geÃ§im", "kira", "enflasyon"),
  duygu = c("olumlu", "olumlu", "olumlu", "olumlu", "olumlu", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", 
            "olumsuz", "olumsuz", "olumlu", "olumlu", "olumlu", "olumsuz",
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz")
)

showtext_auto()
font_add_google("Poppins", "poppins")

```

##### Manuel OluÅŸturulan Duygu Analizi

  Manuel duygu analizinde de negatif aÄŸÄ±rlÄ±klÄ± yorumlarÄ±n bulunduÄŸu sÃ¶ylenebilir. Bunlardan 360 negatif 55'i ise pozitif olduÄŸunu sÃ¶ylemekte.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Trigram uretimi (yorum_df zaten yorumlar verisini iseriyor)
trigramlar_asgari <- yorum_df_asgari %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords)

# Trigram icindeki kelimeleri pivotlayip duygu e??lemesi yap
trigram_duygu_asgari <- trigramlar_asgari %>%
  pivot_longer(cols = c(kelime1, kelime2, kelime3), 
               names_to = "pozisyon", values_to = "kelime") %>%
  left_join(duygu_sozlugu_asgari, by = "kelime") %>%
  filter(!is.na(duygu)) %>%
  count(duygu, sort = TRUE)

ggplot(trigram_duygu_asgari, aes(x = reorder(duygu, -n), y = n, fill = duygu)) +
  geom_col(width = 0.6, color = "white", linewidth = 0.4) +
  geom_text(aes(label = n), vjust = -0.4, size = 6, family = "poppins", fontface = "bold") +
  scale_fill_manual(values = c("olumlu" = "#66bb6a", "olumsuz" = "#ef5350")) +
  labs(
    title = "Asgari Ucret Yorumlarinda Duygu Dagilimi",
    subtitle = "Trigram analizine gore olumlu ve olumsuz ifadelerin fazlaliÄŸi",
    x = NULL, y = NULL
  ) +
  theme_minimal(base_family = "poppins") +
  theme(
    plot.title = element_text(size = 20, hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text = element_text(size = 13, face = "bold"),
    axis.ticks = element_blank(),
    panel.grid.major.y = element_blank(),
    legend.position = "none",
    plot.margin = margin(20, 20, 20, 20)
  )
```


#####Bert Ä°le Duygu analizi

  Bert ile yapÄ±lan duygu analizinde 2654 negatif yorum bulunmaktadÄ±r.  Ortalama ise -0.483 olduÄŸunu bu da yorumlarÄ±n genel anlamda negatife kaydÄ±ÄŸÄ±nÄ± sÃ¶yleyebiliriz. 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
dosya_yolu_asgari <- "C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/yorumlarasgari_duygu.csv"

# Veriyi oku
veri_asgari <- read_csv(dosya_yolu_asgari, locale = locale(encoding = "UTF-8"))
```



```{r,echo=FALSE, message=FALSE, warning=FALSE}
duygu_sayilari_asgari <- veri_asgari %>%
  count(duygu)


ggplot(duygu_sayilari_asgari, aes(x = duygu, y = n, fill = duygu)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = n), vjust = -0.4, size = 4, family = "poppins") +
  scale_fill_viridis(discrete = TRUE) +
  labs(title = "Yorumlarin Duygu Dagilimi", x = "", y = "") +
  theme_minimal(base_family = "poppins") +
  theme(legend.position = "none",
        plot.title = element_text(size = 18, hjust = 0.5, face = "bold"))
```

# 3. Ä°stanbul Depremi Haber Analizi

  Bu haber analizinde amaÃ§ toplumun deprem hakkÄ±ndaki bilinÃ§ dÃ¼zeyini yaÅŸanÄ±lan depremdeki duygularÄ±nÄ± dÃ¼ÅŸÃ¼ncelerini Ã¶ÄŸrenerek olasÄ± bir depremde ne kadar hazÄ±r olduklarÄ±nÄ± Ã¶ÄŸrenmektir.
```{r,echo=FALSE, message=FALSE, warning=FALSE}
# 2. Dosyayi Okuma
dosya_yolu_deprem <- "C:\\Users\\cyurt\\OneDrive\\Belgeler\\sosyalmedyaproje\\depremyorum.csv"
yorumlar_deprem <- read_csv(dosya_yolu_deprem, locale = locale(encoding = "UTF-8"))

# 3. Yorumlardan Stopwords cikartma ve Temizleme
yorumlar_tidy_deprem <- yorumlar_deprem %>%
  unnest_tokens(kelime, Yorumlar) %>%
  filter(!kelime %in% turkce_stopwords) %>%  # Stopwords cikarma
  filter(str_detect(kelime, "^[a-z????????????]+$")) %>%  # Yalnizca harf iceren kelimeler
  mutate(kelime = str_to_lower(kelime))  # Tum kelimeleri kucuk harfe cevirme

```

##### Kelime Bulutu
  Kelime bulutunda elde edilenler â€œdeprem, Ä°stanbul, hoca, Celal, Fatih, kanal, bilim, bina, fay, panikâ€ kavramlarÄ± toplumun korktuÄŸunu, endiÅŸe dÃ¼zeyini hem de konunun sosyal, bilimsel ve duygusal boyutlarÄ±nÄ±n bir arada ele alÄ±ndÄ±ÄŸÄ±nÄ± gÃ¶sterir.
  
```{r,echo=FALSE, message=FALSE, warning=FALSE}
# 4. Kelime Frekanslarini Hesaplama
kelime_frekans_deprem <- yorumlar_tidy_deprem %>%
  count(kelime, sort = TRUE)

## ilk 50 kelimeyi al
kelime_frekans_deprem50 <- kelime_frekans_deprem %>% 
  top_n(100, n)

# Word Cloud'u ciz

wordcloud2(kelime_frekans_deprem50, shape = "diamond")
```

##### Emoji Analizi
  Emoji analizinde kullanÄ±lan ğŸ¥ºemojisi en sÄ±k kullanÄ±lan emoji olup toplumun yaÅŸanan olay karÅŸÄ±sÄ±nda duyduÄŸu endiÅŸe ve Ã¼zÃ¼ntÃ¼yÃ¼ gÃ¼Ã§lÃ¼ biÃ§imde yansÄ±tÄ±r. â¤ï¸emojisi ise toplumsal dayanÄ±ÅŸmayÄ±, sevg, ve destek gÃ¶stergesi olarak yaygÄ±n biÃ§imde kullanÄ±lmÄ±ÅŸtÄ±r. ğŸ˜‚ kahkaha emojisi olan bu emoji muhtemelen ironik ve eleÅŸtirel tepkilerde yer almakta.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
#Emoji analizi

# Yorum metinlerini cek
yorum_metni_deprem <- yorumlar_deprem$Yorumlar

# Emoji Unicode araliÄŸi
emoji_pattern <- "[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\U0001F1E0-\U0001F1FF\U00002700-\U000027BF]"

# Emojileri bul
tum_emojiler_deprem <- str_extract_all(yorum_metni_deprem, emoji_pattern)

# Listeyi duzlestir
tum_emojiler_flat_deprem <- unlist(tum_emojiler_deprem)

# Hangi emojiden kac tane var
emoji_sayim_deprem <- as.data.frame(table(tum_emojiler_flat_deprem)) %>%
  arrange(desc(Freq))

# ilk 10 emojiyi al
emoji_deprem_top10 <- emoji_sayim_deprem %>%
  slice_max(order_by = Freq, n = 10)

# Grafik
ggplot(emoji_deprem_top10, aes(x = reorder(tum_emojiler_flat_deprem, Freq), y = Freq, fill = Freq)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = tum_emojiler_flat_deprem), 
            hjust = -0.5, 
            size = 10, 
            family = "Segoe UI Emoji") + 
  geom_text(aes(label = Freq), 
            hjust = 1.2, 
            color = "white",
            fontface = "bold",
            size = 5) +
  scale_fill_gradient(low = "#add8e6", high = "#005f73") +
  coord_flip() +
  labs(title = "Deprem Yorumlarinda En Cok Kullanilan 10 Emoji", 
       subtitle = "Yorumlardan elde edilen verilere gore emoji kullanimi",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )

```

##### Kelime GruplarÄ±
  YapÄ±lan 2â€™li ve 3â€™lÃ¼ kelime gruplarÄ±na baktÄ±ÄŸÄ±mÄ±zda â€œahmet bey, celal bey, ÅŸener Ã¼ÅŸÃ¼mezsoyâ€ Ã¶ne Ã§Ä±kmasÄ± toplumda onlarÄ± takip ettiÄŸini hatta bu isimleri tanÄ±mayan kiÅŸi bu analizlerden edindiÄŸi bilgi Ä±ÅŸÄ±ÄŸÄ±nda deprem ile ilgilendiÄŸini ya da bu konu hakkÄ±nda videolarÄ± olduÄŸunu anlayabilir. AyrÄ±ca insanlar â€œkanal Ä°stanbul, bÃ¼yÃ¼k Ä°stanbul â€ hakkÄ±nda videolarda bahsettiÄŸini sÃ¶yleyebiliriz. 3â€™lÃ¼ kelime gruplarÄ±nda ise â€œbÃ¼yÃ¼k Ä°stanbul depremiâ€ geÃ§mesi toplum iÃ§inde bu depremin geldiÄŸini veya hatÄ±rlattÄ±ÄŸÄ±nÄ± â€œÃ§Ã¶k kapan tutunâ€ kelime grubunda ise toplumun deprem konusunda bilgisinin ve tecrÃ¼besi olduÄŸu sÃ¶ylenebilir. AyrÄ±ca bu depremin yaÅŸanmasÄ± ile 6 Åubat depreminin akÄ±llara tekrar geldiÄŸi sÃ¶ylenebilir. DiÄŸer bir nokta â€œÅŸilan anneme ulaÅŸabilirâ€ kÄ±smÄ± haber programÄ±nda yaÅŸanÄ±lan bir olayÄ±n halkÄ±n dikkatini Ã§ektiÄŸini ve deÄŸerleri Ã¶n planda tuttuÄŸu sÃ¶ylenebilir.
  
```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Dataframe'e cevir
yorum_df_deprem <- tibble(yorum = yorum_metni_deprem)

# Bigram (iki kelimelik grup) uretimi
bigramlar_deprem <- yorum_df_deprem %>%
  unnest_tokens(bigram, yorum, token = "ngrams", n = 2) %>%
  separate(bigram, into = c("kelime1", "kelime2"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d")) %>%
  unite(bigram, kelime1, kelime2, sep = " ")

# En sik gecen 15 bigram
bigram_sayim_deprem <- bigramlar_deprem %>%
  count(bigram, sort = TRUE) %>%
  slice_max(n, n = 15)

# Grafik
ggplot(bigram_sayim_deprem, aes(x = reorder(bigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#ffe0ac", high = "#ff6f00") +
  labs(title = "Deprem Yorumlarinda En Sik Gecen 2'li Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```


```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Trigram uretimi
trigramlar_deprem <- yorum_df_deprem %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  unite(trigram, kelime1, kelime2, kelime3, sep = " ")

# En sik gecen 15 trigram
trigram_sayim_deprem <- trigramlar_deprem %>%
  count(trigram, sort = TRUE) %>%
  slice_max(n, n = 15)
# Grafik
ggplot(trigram_sayim_deprem, aes(x = reorder(trigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#b3e5fc", high = "#0288d1") +
  labs(title = "Deprem Yorumlarinda En Sik Gecen 3'lu Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```


##### Kelime AÄŸÄ± 
  Kelime AÄŸÄ± analizinde â€œallah korusun, rabbim rahmet eylesin, rahmet Allahâ€™tan olsun, herkesi muhafaza eylesinâ€ gibi ifadeler, kullanÄ±cÄ±larÄ±n duygularÄ±nÄ± ve dini temennilerini dile getirdiklerini gÃ¶stermekte. DiÄŸer bir kelime aÄŸÄ± â€œkanal Ä°stanbul projesiâ€, â€œdeprem riski taÅŸÄ±yorâ€, â€œfay hattÄ± geÃ§iyorâ€, â€œEge denizi aÃ§Ä±klarÄ±ndaâ€, â€œkuzey anadolu fay hattÄ±â€ gibi yapÄ±lar, depremin coÄŸrafi boyutunun halk tarafÄ±ndan tartÄ±ÅŸÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶stermiÅŸtir. 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
trigramlar_deprem <- yorum_df_deprem %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d"))

# Bigram sayisini olustur (trigramlardan bigramlara donusturulmeli)
bigram_counts_deprem <- trigramlar_deprem %>%
  count(kelime1, kelime2) %>%
  filter(n >= 10)

# En sik gecen ilk 350 bigram'i al
bigram_counts_filtered_deprem <- bigram_counts_deprem %>% 
  head(100)

# Dugumler ve kenarlar (filtrelenmis)
nodes_deprem <- data.frame(id = unique(c(bigram_counts_filtered_deprem$kelime1, bigram_counts_filtered_deprem$kelime2)),
                    label = unique(c(bigram_counts_filtered_deprem$kelime1, bigram_counts_filtered_deprem$kelime2)))

edges_deprem <- data.frame(from = bigram_counts_filtered_deprem$kelime1,
                    to = bigram_counts_filtered_deprem$kelime2,
                    value = bigram_counts_filtered_deprem$n,
                    title = paste("Siklik:", bigram_counts_filtered_deprem$n))

# Interaktif network (filtrelenmis)
visNetwork(nodes_deprem, edges_deprem, width = "100%", height = "700px") %>%
  visEdges(smooth = FALSE, arrows = "to") %>%
  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%
  visLayout(randomSeed = 123)

bigram_counts_filtered_deprem <- bigram_counts %>% 
  filter(n >= 10)
```

##### Manuel Duygu Analizi
  Manuel olarak hazÄ±rlanan duygu analizinin de negatif(939) Ã§Ä±kmasÄ± yorumlarÄ±n genel olarak negatif aÄŸÄ±rlÄ±klÄ± olduÄŸunu gÃ¶sterir.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
duygu_sozlugu_ek <- tibble(
  kelime = c("harika", "mÃ¼kemmel", "seviyorum", "gÃ¼zel", "beÄŸendim", 
             "kÃ¶tÃ¼", "berbat", "nefret", "rezalet", "Ã§irkin", 
             "asla", "tiksindim", "sevdim", "sÃ¼per", "bayÄ±ldÄ±m", "hiÃ§",
             "caniligi", "acÄ±masÄ±zlÄ±k", "canavarca", "vahÅŸice", 
             "ÅŸeytan", "vicdansiz","katil","aÅŸaÄŸÄ±lÄ±k","pislik","katil","kati","vahÅŸice","yÄ±kÄ±m", "ihmal", "enkaz", "Ã§Ã¶ktÃ¼", 
             "felaket","Ã¶lÃ¼m", "korkunÃ§", "unutuldu", "Ã§aresiz", "sessizlik","korku","deprem","adaletsiz", "dÃ¼ÅŸÃ¼k", "geÃ§im", "kira", "enflasyon"),
  duygu = c("olumlu", "olumlu", "olumlu", "olumlu", "olumlu", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", 
            "olumsuz", "olumsuz", "olumlu", "olumlu", "olumlu", "olumsuz",
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz")
)

# Var olan duygu sozlugu ile birlestir
duygu_sozlugu_deprem <- bind_rows(duygu_sozlugu_ek, duygu_sozlugu_ek)
# Trigram uret ve stopword'leri filtrele
trigramlar_deprem <- yorum_df_deprem %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords)

# Trigram kelimelerini duygu sozlugu ile eslestir
trigram_duygu_deprem <- trigramlar_deprem %>%
  pivot_longer(cols = c(kelime1, kelime2, kelime3), 
               names_to = "pozisyon", values_to = "kelime") %>%
  left_join(duygu_sozlugu_deprem, by = "kelime") %>%
  filter(!is.na(duygu)) %>%
  count(duygu, sort = TRUE)

# Grafik cizimi
ggplot(trigram_duygu_deprem, aes(x = reorder(duygu, n), y = n, fill = duygu)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  geom_text(aes(label = n), vjust = -0.5, size = 6, fontface = "bold") +
  scale_fill_manual(values = c("olumlu" = "#4caf50", "olumsuz" = "#f44336")) +
  labs(title = "Yorumlardaki Duygu Dagilimi",
       subtitle = "Her trigramdaki anlamli kelimeler duygu sozlugu ile eslestirildi",
       x = "Duygu", y = "Kullanim Sayisi") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
        plot.subtitle = element_text(size = 13, hjust = 0.5))

```
##### Bert ile Duygu Analizi
  Deprem hakkÄ±nda yapÄ±lan Bert analizinde Negatif duygunun 2486 Ã§Ä±karak aÄŸÄ±rlÄ±klÄ± olduÄŸunu gÃ¶rÃ¼ldÃ¼.  Ortalama duygu skorunun â€œ-0.145â€ yani negatif Ã§Ä±kmÄ±ÅŸtÄ±r. Ama bu durum negatif bir duygu durumunu yansÄ±ttÄ±ÄŸÄ±nÄ± gÃ¶steriyor. Deprem gibi bir felaket durumun bÃ¶yle sonuÃ§lar beklenebilir Ã§Ã¼nkÃ¼ insanlar genellikle endiÅŸe, Ã¼zÃ¼ntÃ¼ ve korku gibi olumsuz duygularÄ± ifade eder. Standart sapma ve varyans baktÄ±ÄŸÄ±mÄ±zda nispete 1â€™e yakÄ±n Ã§Ä±kmÄ±ÅŸtÄ±r. Bu da yorumlar arasÄ±nda belirgin duygu Ã§eÅŸitliliÄŸi olduÄŸunu gÃ¶sterir. Sebebi ise yardÄ±mlaÅŸma veya dayanÄ±ÅŸma iÃ§eren yorumlarÄ±n pozitif duygular iÃ§ermesi olabilir. 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Dosya yolunu belirt
dosya_yolu_deprem_duygu <- "C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/yorumlardeprem_duygu.csv"

# Veriyi oku
veri_deprem <- read_csv(dosya_yolu_deprem_duygu, locale = locale(encoding = "UTF-8"))
```

```{r,echo=FALSE, message=FALSE, warning=FALSE}
duygu_df_deprem <- read.csv("C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/yorumlardeprem_duygu.csv")
```


```{r,echo=FALSE, message=FALSE, warning=FALSE}
# Duygu dagilimi hesapla
polarite_sayilari_deprem <- duygu_df_deprem %>%
  group_by(duygu) %>%
  summarise(sayi = n())

# Grafikle goster
ggplot(polarite_sayilari_deprem, aes(x = reorder(duygu, -sayi), y = sayi, fill = duygu)) +
  geom_bar(stat = "identity", width = 0.6) +
  scale_fill_manual(values = c("positive" = "#2ecc71", "neutral" = "#95a5a6", "negative" = "#e74c3c")) +
  labs(title = "Yorumlarin Duygu Dagilimi",
       x = "Duygu Turu",
       y = "Yorum Sayisi") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"))
```

# 4. Ä°klim Degisikligi Haber Analizi

```{r,echo=FALSE, message=FALSE, warning=FALSE}
dosya_yolu_iklim <- "C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/iklimdegisikligi.csv"
yorumlar_iklim <- read_csv(dosya_yolu_iklim, locale = locale(encoding = "UTF-8"))
```

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorumlar_tidy_iklim <- yorumlar_iklim %>%
  unnest_tokens(kelime, Yorumlar) %>%
  filter(!kelime %in% turkce_stopwords) %>%  
  filter(str_detect(kelime, "^[a-z????????????]+$")) %>%
  mutate(kelime = str_to_lower(kelime))
```

##### Kelime Bulutu
  Ä°klim deÄŸiÅŸikliÄŸi hakkÄ±nda yapÄ±lan yorumlarda kelime bulutuna yansÄ±yanlardan bahsedecek olursam konu ile iliÅŸkili olan â€œiklim, kozmik, karbon, manyetik, okyanuslar, radyasyon, atmosfer, suâ€ kelimeleri Ã¶ne Ã§Ä±kmakta bu da bireylerin bu konu hakkÄ±nda bilgi sahibi olduÄŸunu sÃ¶ylenebilir. DiÄŸer gÃ¶ze Ã§arpan kelimeler â€œkanun, insan, Allah, kabulâ€ kelimeleri de diÄŸer Ã¶ne Ã§Ä±kan kelimelerdendir. 
```{r,echo=FALSE, message=FALSE, warning=FALSE}
kelime_frekans_iklim <- yorumlar_tidy_iklim %>%
  count(kelime, sort = TRUE)

## ??lk 50 kelimeyi al
kelime_frekans_top50_iklim <- kelime_frekans_iklim %>% 
  top_n(100, n)

# Word Cloud'u ??iz
wordcloud2(kelime_frekans_top50_iklim, size = 2, minRotation = -pi/6, maxRotation = pi/6, rotateRatio = 0.5)


wordcloud2(kelime_frekans_top50_iklim, shape = "diamond")
```

##### Emoji Analizi
  Emoji analizimizde â€œkalp, alkÄ±ÅŸ, gÃ¼lme, beÄŸenme, dua, Ã¼zgÃ¼nâ€ Ã¶ne Ã§Ä±kmakta bunlarÄ±n ise videolarÄ± beÄŸendiklerini ayrÄ±ca konu hakkÄ±nda endiÅŸeli olduklarÄ± sÃ¶ylenebilir. 
```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_metni_iklim <- yorumlar_iklim$Yorumlar

# Emoji Unicode aralÄ±ÄŸÄ±
emoji_pattern <- "[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\U0001F1E0-\U0001F1FF\U00002700-\U000027BF]"

# Emojileri bul
tum_emojiler_iklim <- str_extract_all(yorum_metni_iklim, emoji_pattern)

# Listeyi dÃ¼zleÅŸtir
tum_emojiler_flat_iklim <- unlist(tum_emojiler_iklim)

# Hangi emojiden kaÃ§ tane var
emoji_sayim_iklim <- as.data.frame(table(tum_emojiler_flat_iklim)) %>%
  arrange(desc(Freq))

# Ä°lk 10 emojiyi al
emoji_top10_iklim <- emoji_sayim_iklim %>%
  slice_max(order_by = Freq, n = 10)

# Grafik
ggplot(emoji_top10_iklim, aes(x = reorder(tum_emojiler_flat_iklim, Freq), y = Freq, fill = Freq)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = tum_emojiler_flat_iklim), 
            hjust = -0.5, 
            size = 10, 
            family = "Segoe UI Emoji") + 
  geom_text(aes(label = Freq), 
            hjust = 1.2, 
            color = "white",
            fontface = "bold",
            size = 5) +
  scale_fill_gradient(low = "#add8e6", high = "#005f73") +
  coord_flip() +
  labs(title = "Iklim Degisikligi Yorumlarinda En Cok Kullanilan 10 Emoji", 
       subtitle = "Yorumlardan elde edilen verilere gore emoji kullanÄ±mÄ±",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )
```

##### 2'li ve 3'lÃ¼ Kelime GruplarÄ±
  En sÄ±k kullanÄ±lan kelime gruplarÄ±nÄ± 2â€™li olarak ele alÄ±ndÄ±. Bunu sonucunda toplumun iklim deÄŸiÅŸikliÄŸi hakkÄ±nda yeterli bilgi ve tecrÃ¼beye sahip olduÄŸunu hatta detaylÄ± bir ÅŸekilde iÃ§erdiÄŸi konu baÅŸlÄ±klarÄ±nÄ± kullandÄ±klarÄ±nÄ± kelime gruplarÄ±nda gÃ¶rmekteyiz. Ã–rneÄŸin kozmik radyasyon, aÅŸÄ±rÄ± enerji, iklim kanunu, gÃ¼neÅŸ sistemi, karbon ayak izleri gibi sÃ¶zcÃ¼klerle bu sonuca varÄ±labilir.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_df_iklim <- tibble(yorum = yorum_metni_iklim)

# Bigram (iki kelimelik grup) uretimi
bigramlar_iklim <- yorum_df_iklim %>%
  unnest_tokens(bigram, yorum, token = "ngrams", n = 2) %>%
  separate(bigram, into = c("kelime1", "kelime2"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d")) %>%
  unite(bigram, kelime1, kelime2, sep = " ")

# En cok gecen 15 bigram
bigram_sayim_iklim <- bigramlar_iklim %>%
  count(bigram, sort = TRUE) %>%
  slice_max(n, n = 15)

# Grafik
ggplot(bigram_sayim_iklim, aes(x = reorder(bigram, n), y = n, fill = n)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  coord_flip() +
  geom_text(aes(label = n), hjust = -0.2, size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#ffe0ac", high = "#ff6f00") +
  labs(title = "Ä°klim Haber Yorumlarinda En Sik Gecen 2'li Kelime Gruplari",
       subtitle = "Turkce durak kelimeler haric tutulmustur",
       x = NULL, y = "Kullanim Sayisi") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    axis.text.x = element_text(face = "italic"),
    panel.grid.major.y = element_blank()
  )
```

##### Kelime AÄŸÄ±
  Kelime aÄŸÄ±nda ise kelime grubunda olduÄŸu gibi toplumun bu konuda bilgili olduÄŸunu birbiriyle iliÅŸkili kelimelerden Ã§Ä±karÄ±m yapabiliriz. Bunlar dÄ±ÅŸÄ±nda iklim kanunu kabul eden v etmeyen kesim olarak ayrÄ±ÅŸma var bu da aslÄ±nda toplumun belirli bir kesimin iklim kanunu kabul ettiÄŸini ama bazÄ± kesimlerinde bir o kadar reddettiÄŸini anlamÄ±ÅŸ bulunmaktayÄ±z. AslÄ±nda duygu analizi kÄ±smÄ±nda da duygularÄ±n birbirine yakÄ±n olmasÄ±nÄ±n diÄŸer bir sebebi de kabul eden ve etmeyen olarak ayrÄ±lan kesime atÄ±f olabilir. 
  
```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_df_iklim <- tibble(yorum = yorumlar_iklim$Yorumlar)

# Trigram cikarma ve temizleme
trigramlar_iklim <- yorum_df_iklim %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords,
         !str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d"),
         str_detect(kelime1, "^[a-z????????????]+$"),
         str_detect(kelime2, "^[a-z????????????]+$"),
         str_detect(kelime3, "^[a-z????????????]+$")) %>%
  mutate(across(c(kelime1, kelime2, kelime3), str_to_lower))

# Trigramlardan bigram (kelime1-kelime2) uret ve frekans hesapla
bigram_counts_iklim <- trigramlar_iklim %>%
  count(kelime1, kelime2, sort = TRUE) %>%
  filter(n >= 4)

# En sik gecen ilk 200 bigram'i al
bigram_counts_filtered_iklim <- bigram_counts_iklim %>% 
  slice_max(order_by = n, n = 100)

#Node ile frekans hesapla (hem kelime1 hem kelime2 i??in)
node_freq1_iklim <- bigram_counts_filtered_iklim %>%
  group_by(kelime1) %>%
  summarise(freq = sum(n)) %>%
  rename(id = kelime1)

node_freq2_iklim <- bigram_counts_filtered_iklim %>%
  group_by(kelime2) %>%
  summarise(freq = sum(n)) %>%
  rename(id = kelime2)

# Frekanslari birlestir
node_freq_all_iklim <- bind_rows(node_freq1_iklim, node_freq2_iklim) %>%
  group_by(id) %>%
  summarise(freq = sum(freq))

# Dugum veri cercevesi (gorsellestirme icin stil ozellikleri ile)
nodes <- node_freq_all_iklim %>%
  mutate(label = id,
         value = freq,
         title = paste0("Kelime: ", id, "<br>Frekans: ", freq),
         color = "rgba(255,105,180,0.8)",  # Pembe ton
         font = list(size = 20))

# Kenar veri cercevesi
edges <- data.frame(
  from = bigram_counts_filtered_iklim$kelime1,
  to = bigram_counts_filtered_iklim$kelime2,
  value = bigram_counts_filtered_iklim$n,
  title = paste("Siklik:", bigram_counts_filtered_iklim$n),
  color = list(color = "steelblue", highlight = "red")
)

# Interaktif visNetwork grafigi
visNetwork(nodes, edges, width = "100%", height = "700px") %>%
  visEdges(smooth = TRUE, arrows = "to") %>%
  visOptions(highlightNearest = list(enabled = TRUE, degree = 1, hover = TRUE),
             nodesIdSelection = TRUE) %>%
  visLayout(randomSeed = 123) %>%
  visPhysics(stabilization = TRUE) %>%
  visInteraction(navigationButtons = TRUE) %>%
  visNodes(shape = "dot", shadow = TRUE)
```

##### Manuel Duygu Analizi
  Bu duygu analizinde manuel olarak duygular iÃ§ermekte. Bunun sonucunda yorumlar 136 negatif, 121 pozitif iÃ§ermektedir. 

```{r,echo=FALSE, message=FALSE, warning=FALSE}
yorum_df_iklim <- tibble(yorum = yorumlar_iklim$Yorumlar)

# Genisletilmis Turkce duygu sozlugu
duygu_sozlugu <- tibble(
  kelime = c("harika", "mÃ¼kemmel", "seviyorum", "gÃ¼zel", "beÄŸendim", 
             "kÃ¶tÃ¼", "berbat", "nefret", "rezalet", "Ã§irkin", 
             "asla", "tiksindim", "sevdim", "sÃ¼per", "bayÄ±ldÄ±m", "hiÃ§",
             "caniligi", "acÄ±masÄ±zlÄ±k", "canavarca", "vahÅŸice", 
             "ÅŸeytan", "vicdansiz","katil","aÅŸaÄŸÄ±lÄ±k","pislik","katil","kati","vahÅŸice","yÄ±kÄ±m", "ihmal", "enkaz", "Ã§Ã¶ktÃ¼", 
             "felaket","Ã¶lÃ¼m", "korkunÃ§", "unutuldu", "Ã§aresiz", "sessizlik","korku","deprem","adaletsiz", "dÃ¼ÅŸÃ¼k", "geÃ§im", "kira", "enflasyon","hayÄ±r","evet","deÄŸiÅŸikliÄŸe evet"),
  duygu = c("olumlu", "olumlu", "olumlu", "olumlu", "olumlu", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", 
            "olumsuz", "olumsuz", "olumlu", "olumlu", "olumlu", "olumsuz",
            "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz","olumsuz", 
            "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz", "olumsuz", "olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz", "olumsuz", "olumsuz","olumsuz","olumsuz","olumsuz","olumlu","olumlu")
)

# Trigram uret ve stopword'leri filtrele
trigramlar_iklim <- yorum_df_iklim %>%
  unnest_tokens(trigram, yorum, token = "ngrams", n = 3) %>%
  separate(trigram, into = c("kelime1", "kelime2", "kelime3"), sep = " ") %>%
  filter(!str_detect(kelime1, "\\d"),
         !str_detect(kelime2, "\\d"),
         !str_detect(kelime3, "\\d")) %>%
  filter(!kelime1 %in% turkce_stopwords,
         !kelime2 %in% turkce_stopwords,
         !kelime3 %in% turkce_stopwords)

# Trigram kelimelerini duygu sozlugu ile eslestir
trigram_duygu_iklim <- trigramlar_iklim %>%
  pivot_longer(cols = c(kelime1, kelime2, kelime3), 
               names_to = "pozisyon", values_to = "kelime") %>%
  left_join(duygu_sozlugu, by = "kelime") %>%
  filter(!is.na(duygu)) %>%
  count(duygu, sort = TRUE)

# Grafik cizimi
ggplot(trigram_duygu_iklim, aes(x = reorder(duygu, n), y = n, fill = duygu)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  geom_text(aes(label = n), vjust = -0.5, size = 6, fontface = "bold") +
  scale_fill_manual(values = c("olumlu" = "#4caf50", "olumsuz" = "#f44336")) +
  labs(title = "Yorumlardaki Duygu Dagilimi",
       subtitle = "Her trigramdaki anlamli kelimeler duygu sozlugu ile eslestirildi",
       x = "Duygu", y = "Kullanim Sayisi") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
        plot.subtitle = element_text(size = 13, hjust = 0.5))

```


##### Bert ile Duygu Analizi 
  Ä°klim deÄŸiÅŸikliÄŸi ve iklim kanunu hakkÄ±ndaki yorumlarÄ±n duygu daÄŸÄ±lÄ±mÄ±nÄ± iÃ§eren bir analiz yapmÄ±ÅŸ bulunmaktayÄ±m. Bu analizde asÄ±l hedef iklim deÄŸiÅŸikliÄŸi konusunda bireylerin pozitif ve negatif dÃ¼ÅŸÃ¼ncelerini Ã¶ÄŸrenmektir. Bunlar sonucunda 1509 negatif dÃ¼ÅŸÃ¼nce, 1383 pozitif dÃ¼ÅŸÃ¼nce vardÄ±r. Duygu skorlarÄ±na baktÄ±ÄŸÄ±mÄ±zda ortalama â€œ-0.044â€ dur bu da yorumlarÄ±n genel olarak hafif negatif bir duygu durumunu yansÄ±ttÄ±ÄŸÄ±nÄ± gÃ¶sterir. Ancak ortalama sÄ±fÄ±ra Ã§ok yakÄ±n olduÄŸu iÃ§in, yorumlarÄ±n neredeyse nÃ¶tre yakÄ±n olduÄŸu da sÃ¶ylenebilir. Bu durum, iklim deÄŸiÅŸikliÄŸi gibi ciddi bir konuda insanlarÄ±n ifadelerinin karamsarlÄ±k olduÄŸu sÃ¶yleyebiliriz. Varyans ve standart sapma deÄŸerleri 1'e Ã§ok yakÄ±n, bu da yorumlar arasÄ±nda belirgin bir duygu Ã§eÅŸitliliÄŸi olduÄŸunu gÃ¶steriyor. BazÄ± yorumlar yoÄŸun negatif, bazÄ±larÄ± ise nÃ¶tr veya hafif pozitif olabilir. Bu, konunun toplumda kutuplaÅŸmaya veya farklÄ± bakÄ±ÅŸ aÃ§Ä±larÄ±na yol aÃ§tÄ±ÄŸÄ±nÄ± dÃ¼ÅŸÃ¼ndÃ¼rÃ¼yor.

```{r,echo=FALSE, message=FALSE, warning=FALSE}
dosya_yolu_iklim <- "C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/yorumlar_duygu.csv"

# Veriyi oku
veri_iklim <- read_csv(dosya_yolu_iklim, locale = locale(encoding = "UTF-8"))


# Veriyi oku
duygu_df_iklim <- read.csv("C:/Users/cyurt/OneDrive/Belgeler/sosyalmedyaproje/yorumlar_duygu.csv")

# Duygu dagilimini hesapla
polarite_sayilari_iklim <- duygu_df_iklim %>%
  group_by(duygu) %>%
  summarise(sayi = n())

# Grafikle g??ster
ggplot(polarite_sayilari_iklim, aes(x = reorder(duygu, -sayi), y = sayi, fill = duygu)) +
  geom_bar(stat = "identity", width = 0.6) +
  scale_fill_manual(values = c("positive" = "#2ecc71", "neutral" = "#95a5a6", "negative" = "#e74c3c")) +
  labs(title = "Yorumlarin Polarite Dagilimi",
       x = "Duygu Turu",
       y = "Yorum Sayisi") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"))

```


# 5. SonuÃ§

  SonuÃ§ olarak projemde asÄ±l hedefimin toplum iÃ§erisinde berliediÄŸim konu baÅŸlÄ±klarÄ±na verdiÄŸi tepkileri â€œYoutubeâ€ Ã¼zerinden yorumlarÄ±na ulaÅŸarak onlarÄ± analiz etmektir. Her bir konuyu aÃ§Ä±klayacak olursam
  Ahmet Minguzzi OlayÄ± toplum iÃ§erisinde fazlasÄ±yla tepkiyle karÅŸÄ±lanan olay demek yanlÄ±ÅŸ olmaz. Ã‡Ã¼nkÃ¼ keskin cÃ¼mleler ile idam istenmesi ayrÄ±ca aile olan baÅŸ saÄŸlÄ±ÄŸÄ± dilekleri durumun toplum tarafÄ±ndan Ã¼zÃ¼cÃ¼ karÅŸÄ±landÄ±ÄŸÄ±nÄ± bize aÃ§Ä±kÃ§a belirtir.
  
  Ä°stanbul Deprem Haberleri toplumun bu konu hakkÄ±nda bilinÃ§li olduÄŸunu ayrÄ±ca bireylerin bu konu hakkÄ±nda hassas noktalarÄ± unutmadÄ±ÄŸÄ±nÄ± anlayabiliriz. AyrÄ±ca yapÄ±lan analizler sonucunda toplumun bÃ¼yÃ¼k Ã§oÄŸunluÄŸu bu konu hakkÄ±nda korku ve endiÅŸe iÃ§erisinde olduÄŸunu belirtebiliriz.
  
  Asgari Ãœcret Haberleri elde edilen veriler sayesinde belirli kesimin asgari Ã¼cret konusunda mutlu olmadÄ±ÄŸÄ±nÄ± ve emekli kesimin de asgari Ã¼creti artÄ±k ilgilendirdiÄŸini sÃ¶yleyebiliriz.
  
  Ä°klim DeÄŸiÅŸikliÄŸi Haberlerini analiz ederek elde ettiÄŸim yorumlar Ä±ÅŸÄ±ÄŸÄ±nda toplumun belirli kesimin iklim deÄŸiÅŸikliÄŸi hakkÄ±nda yeterli bilgiye sahip olduÄŸunu sÃ¶yleyebilirim. Ã–yle ki gerek kelime gruplarÄ± gerek kelime bulutlarÄ±nda bunu ispatlamÄ±ÅŸtÄ±r. Ama diÄŸer Ã§arpÄ±cÄ± bir konu toplumun iklim kanunu kabul olmasÄ±nÄ± isteyen ve istemeyen taraf olarak ikiye ayrÄ±ldÄ±ÄŸÄ±nÄ± sÃ¶yleyebiliriz.
  
	YapmÄ±ÅŸ olduÄŸum proje kapsamÄ±nda toplumun haberlere karÅŸÄ± tepkilerini Ã¶lÃ§erek tek bir platform Ã¼zerinden analizler ile Ã§Ä±ktÄ± saÄŸlamayÄ± amaÃ§ladÄ±m. 


